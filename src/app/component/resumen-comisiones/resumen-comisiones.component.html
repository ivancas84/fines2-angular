<ng-template #loading>
  <mat-progress-bar mode="indeterminate"></mat-progress-bar>
</ng-template>

<form *ngIf="(loadParams$ | async); else loading" 
      (ngSubmit)="onSubmit()" 
      novalidate autocomplete="off">

  <ng-container *ngIf="(loadDisplay$ | async); else loading">
    <mat-progress-bar *ngIf="!load" 
                      mode="indeterminate"></mat-progress-bar>

    <table mat-table 
           [dataSource]="control.controls" 
           class="mat-elevation-z8">
      <ng-container *ngFor="let item of config.controls | keyvalue" [matColumnDef]="item.key">
  
        <th mat-header-cell *matHeaderCellDef> {{item.value.label}} </th>
        
        <td mat-cell *matCellDef="let row; let i = index;">
          <core-abstract-control-view [control]="row.controls[item.key]" 
                                      [config]="item.value"
                                      ></core-abstract-control-view>
        </td>
      </ng-container>

      <ng-container matColumnDef="options">
        <th mat-header-cell *matHeaderCellDef> Opciones </th>
        <td mat-cell *matCellDef="let row; let i = index;">
          <core-abstract-control-view *ngFor="let o of optColumn" 
                                      [control]="row" 
                                      [config]="o" 
                                      [index]="i"></core-abstract-control-view>
        </td>
        <td mat-footer-cell *matFooterCellDef></td>
      </ng-container>
  
      <tr mat-header-row 
          *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row 
          *matRowDef="let row; columns: displayedColumns; let i = index"
          [ngClass]="{'highlight': !row.controls['docente'].value}"></tr>
    </table>
    
    
  </ng-container>
  <!-- <p>Debug Form value: {{ control.value | json }}</p>
  <p>Debug Form status: {{ control.status | json }}</p> -->

</form>