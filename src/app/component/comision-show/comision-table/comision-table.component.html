<ng-template #loading>
  <mat-progress-bar mode="indeterminate"></mat-progress-bar>
</ng-template>

<mat-card>
  <mat-card-header>
    <mat-card-title>Comision</mat-card-title>
  </mat-card-header>
  <mat-card-content *ngIf="(load$ | async) && load; else loading">
    <div *ngFor="let row of dataSource">
      <div  fxLayout fxLayout.xs="column">
        <div fxFlex="50%" fxFlex.xs="100%">
          <mat-card class="comision">
            <mat-card-header>
              <mat-card-title>
                {{row.sede_.numero}} 
                {{row.division}} 
                <span *ngIf="row.planificacion">{{row.planificacion_.anio}}{{row.planificacion_.semestre}}</span>
              </mat-card-title>
              <mat-card-subtitle>{{row.sede_.nombre}}</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <mat-list role="list" >
                <mat-list-item *ngIf="row.planificacion" role="listitem">{{row.planificacion_.plan_.orientacion}} - {{row.planificacion_.plan_.distribucion_horaria}}</mat-list-item>
                <mat-list-item *ngIf="row.calendario" role="listitem">{{row.calendario_.anio | toDate | date:"y"}}-{{row.calendario_.semestre}}</mat-list-item>
              </mat-list>
            </mat-card-content>
            <mat-card-actions>
              <a routerLink="/comision-admin" [queryParams]="{'id':row.id}"><mat-icon>open_in_new</mat-icon></a>
              <a routerLink="/curso-admin" [queryParams]="{'id':row.id}"><mat-icon>calendar_today</mat-icon></a>
            </mat-card-actions>
          </mat-card>
        </div>
        <div fxFlex="50%" fxFlex.xs="100%">
            <mat-card *ngFor="let curso of row.cursos">
              <mat-card-content>
                 <strong>{{curso.asignatura_.nombre}} IGE {{curso.ige}}<a routerLink="/toma-admin" [queryParams]="{'id':curso.id}"><mat-icon>edit</mat-icon></a></strong>  
                <br><span class="mat-small">&nbsp;{{curso.horario}} - {{curso.horas_catedra}} horas c√°tedra</span>
                
                <mat-list role="list" dense>
                  <mat-list-item *ngFor="let toma of curso.tomas" role="listitem" [ngClass]="{'green': toma.estado == 'Aprobada', 'yellow': toma.estado == 'Pendiente'}">
                    <span *ngIf="toma.docente">{{toma.docente_.nombres}} {{toma.docente_.apellidos}}</span>&nbsp;{{toma.fecha_toma | toDate | date:"d/M/y"}}
                  </mat-list-item>
                </mat-list>
              </mat-card-content>
            </mat-card>  
        </div>
      </div>
      <mat-divider></mat-divider>
    </div>

    <mat-paginator *ngIf="display"
                   [length]="length"
                   [pageSize]="display.size"
                   [pageIndex]="display.page-1"
                   (page)="onChangePage($event)"
                   [pageSizeOptions]="[10, 25, 50, 100]" 
                   showFirstLastButtons>
    </mat-paginator>  
  </mat-card-content>
</mat-card>
